// Generated by CoffeeScript 1.7.1
var RE_TITLE, request;

request = require("request");

RE_TITLE = /<title>(.+?)<\/title>/i;

exports.parse = function(url, callback, timeout) {
  var args;
  timeout = timeout || 5000;
  args = {
    "url": url,
    "timeout": timeout
  };
  return request(args, function(error, response, body) {
    var title;
    if (error || response.statusCode !== 200) {
      return callback({
        'error': error
      });
    } else {
      title = body.match(RE_TITLE);
      if (title) {
        title = title[1];
      } else {
        title = '';
      }
      return callback({
        'title': title,
        'favicon': 'https://www.google.com/s2/favicons?domain=' + url
      });
    }
  });
};
